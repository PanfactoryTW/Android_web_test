<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkbox Accessibility Test Station</title>
    <style>
        body { font-family: sans-serif; padding: 20px; line-height: 1.6; color: #333; }
        .test-section { margin-bottom: 30px; border: 1px solid #ccc; padding: 15px; border-radius: 8px; }
        .custom-cb { display: inline-block; padding: 5px 10px; border: 2px solid #555; cursor: pointer; background: #f9f9f9; }
        .custom-cb[aria-checked="true"]::before { content: "✅ "; }
        .custom-cb[aria-checked="false"]::before { content: "⬜ "; }
        .custom-cb[aria-disabled="true"] { opacity: 0.5; cursor: not-allowed; border-color: #999; }
        .error-text { color: #d93025; font-size: 0.9em; display: block; margin-top: 5px; }
        h2 { border-bottom: 2px solid #eee; padding-bottom: 5px; }
    </style>
</head>
<body>
    <h1>General User Preferences - Checkbox Test</h1>

    <section class="test-section">
        <h2>1. Notification Settings (Native)</h2>
        <div>
            <label><input type="checkbox"> Receive weekly newsletter</label>
        </div>
        <div>
            <label><input type="checkbox" checked> Enable SMS notifications</label>
        </div>
        <div>
            <label><input type="checkbox" disabled> Beta program (Closed)</label>
        </div>
        <div>
            <label><input type="checkbox" checked disabled> Terms of Service accepted</label>
        </div>
    </section>

    <section class="test-section">
        <h2>2. Display Options (ARIA)</h2>
        <div role="checkbox" aria-checked="false" tabindex="0" class="custom-cb">
            Dark mode
        </div>
        <div style="margin-top: 10px;">
            <div role="checkbox" aria-checked="true" aria-disabled="true" tabindex="0" class="custom-cb">
                High contrast (System enforced)
            </div>
        </div>
    </section>

    <section class="test-section">
        <h2>3. Consent & Validation</h2>
        <div>
            <label>
                <input type="checkbox" required aria-invalid="true" aria-describedby="err-1">
                I agree to the Privacy Policy
            </label>
            <span id="err-1" class="error-text">Error: This field is required to proceed.</span>
        </div>
    </section>

    <section class="test-section">
        <fieldset>
            <legend>4. Shipping Preferences (Fieldset Group)</legend>
            <label><input type="checkbox" name="ship" value="door"> Door-to-door delivery</label><br>
            <label><input type="checkbox" name="ship" value="pickup"> Local pickup point</label><br>
            <label><input type="checkbox" name="ship" value="express"> International express</label>
        </fieldset>
    </section>

    <section class="test-section">
        <h2>5. Bulk Actions</h2>
        <label>
            <input type="checkbox" id="master-cb"> Select all items (Mixed state)
        </label>
    </section>

    <script>
        // Set indeterminate state via JS
        document.getElementById('master-cb').indeterminate = true;

        // ARIA Checkbox Toggle Logic
        document.querySelectorAll('[role="checkbox"]').forEach(cb => {
            cb.addEventListener('click', function() {
                if (this.getAttribute('aria-disabled') === 'true') return;
                const isChecked = this.getAttribute('aria-checked') === 'true';
                this.setAttribute('aria-checked', !isChecked);
            });
            // Support Space key for accessibility
            cb.addEventListener('keydown', function(e) {
                if (e.code === 'Space') {
                    e.preventDefault();
                    this.click();
                }
            });
        });
    </script>
</body>
</html>
